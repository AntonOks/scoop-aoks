{
    "version": "2023.2.39",
    "description": "Conveniently manage all your cloud services as a network drive using the standard file explorer.",
    "homepage": "https://www.raidrive.com/",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.raidrive.com/about/terms"
    },
    "architecture": {
        "64bit": {
            "url": "https://app.raidrive.com/d86ea6fa40f74010914976063f94774b/release/stable/RaiDrive_2023.2.39_x64.exe#/_RaiDrive.exe",
            "hash": "cd0572d3482e02e04783f845448b9ca41cfb489dee7823348397db814d13a6a8"
        },
        "32bit": {
            "url": "https://app.raidrive.com/d86ea6fa40f74010914976063f94774b/release/stable/RaiDrive_2023.2.39_x86.exe#/_RaiDrive.exe",
            "hash": "a8bab9aa4e4a4cdef63d0b31f29245c84272a0fe0d13aed4242b15d4e1d78852"
        }
    },
    "pre_install": [
        "IF (-NOT (Test-Path \"C:\\Temp\\RaiDrive\")) { New-Item \"C:\\Temp\\RaiDrive\" -ItemType Directory | Out-Null }",
        "IF (-NOT (Test-Path \"$dir\")) { New-Item \"$dir\" -ItemType Directory | Out-Null }"
    ],
    "##": "https://www.advancedinstaller.com/user-guide/exe-setup-file.html",
    "installer": {
        "args": [
            "/noprereqs",
            "/quiet",
            "/qn",
            "/norestart",
            "/l*vx",
            "$dir\\RaiDrive.log",
            "APPDIR=$dir"
        ]
    },
    "uninstaller": {
        "script": [
            "Stop-Process -Name RaiDrive* -Force",
            "$ID = (Get-CimInstance Win32_Product -FILTER \"Name = 'RaiDrive'\").IdentifyingNumber",
            "msiexec.exe /x \"$ID\" /qn",
            "    # Prevent failed installation",
            "Start-Sleep -Seconds 3"
        ]
    },
    "bin": "raidrive.exe",
    "shortcuts": [
        [
            "raidrive.exe",
            "RaiDrive"
        ]
    ],
    "checkver": {
        "script": [
            "$url  = 'https://www.raidrive.com/download'",
            "$cont = $(Invoke-WebRequest($url)).CONTENT",
            "IF(($cont -MATCH 'id=\"pack_windows_x64\" href=\"https://app.raidrive.com/([a-z0-9]+)/release/stable/RaiDrive_([\\d\\.]+)_x64.exe\">x64</a>')) {",
            "    $x64_tmp_dir = $matches[1]",
            "    $x64_version = $matches[2]",
            "} ELSE {",
            "    ERROR 'NO x64 match found!'",
            "}",
            "",
            "IF(($cont -MATCH 'id=\"pack_windows_x86\" href=\"https://app.raidrive.com/([a-z0-9]+)/release/stable/RaiDrive_([\\d\\.]+)_x86.exe\">x86</a>')) {",
            "    $x86_tmp_dir = $matches[1]",
            "    $x86_version = $matches[2]",
            "} ELSE {",
            "    ERROR 'NO x86 match found!'",
            "}",
            "",
            "IF($x64_version -NE $x86_version) { ERROR '  Version for 64-bit and 32-bit does not match, aborting autoupdate'; CONTINUE }",
            "IF($x64_tmp_dir -NE $x86_tmp_dir) { ERROR ' URL path for 64-bit and 32-bit does not match, aborting autoupdate'; CONTINUE }",
            "Write-Output $x64_version $x64_tmp_dir"
        ],
        "regex": "([\\d.]+) ([a-z0-9]+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://app.raidrive.com/$match2/release/stable/RaiDrive_$version_x64.exe#/_RaiDrive.exe"
            },
            "32bit": {
                "url": "https://app.raidrive.com/$match2/release/stable/RaiDrive_$version_x86.exe#/_RaiDrive.exe"
            }
        }
    }
}
